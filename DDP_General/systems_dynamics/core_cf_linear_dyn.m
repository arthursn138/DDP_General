function [f, fx, fu, x, u] = core_cf_linear_dyn(dt)

n = 14; m = 4;      % State and input dimentions
x = sym('x',[n 1]);
u = sym('u',[m 1]);

sys_Id = [-6.5137e-02,  9.8671e-02, -1.7810e-01,  1.1379e-01, -3.3912e-02,...
         -2.0653e-01, -1.3802e-01, -1.5172e-01, -7.1039e-02, -5.8522e-02,...
          1.8226e-01, -3.9216e-02,  8.4273e-02,  2.9515e-02, -5.2090e-03,...
          2.0736e-01,  1.6216e-01,  2.1252e-01;...
          
          -1.7717e-01,  1.3697e-01,  8.5659e-02, -8.4626e-02,  1.6217e-01,...
         -4.8885e-02, -8.6139e-02,  1.6916e-01, -1.9533e-01, -2.8876e-02,...
         -1.4365e-01, -6.6230e-02,  5.7848e-02,  6.7489e-03,  2.1282e-01,...
          1.7530e-01,  7.0342e-03,  1.8356e-01;...
          
          -1.5610e-01,  7.4637e-02,  9.1121e-02,  7.7229e-02, -8.9885e-02,...
          1.2530e-01, -2.3283e-01,  2.0188e-01, -5.0460e-02, -1.3553e-01,...
         -1.5476e-01,  1.0405e-01, -1.4070e-02,  1.6773e-01, -1.1068e-01,...
          7.7669e-02, -1.3116e-01,  2.8202e-01;...
          
          -1.3962e-01,  7.3774e-02,  1.7712e-02, -5.7952e-02,  1.3453e-01,...
          7.0926e-02, -1.0574e-01,  1.2566e-01,  1.8359e-02,  1.9082e-02,...
          1.8995e-01, -5.8839e-02,  3.5604e-02,  1.7899e-01, -5.6781e-02,...
         -7.0537e-02, -9.5764e-02,  4.1376e-01;...
         
         -2.0524e-01, -3.1789e-02,  1.6850e-01,  8.1084e-02,  1.4614e-01,...
          9.3138e-02, -2.4683e-01, -1.6383e-01,  5.0001e-02,  1.2981e-01,...
          7.3956e-02,  1.9423e-01, -2.3241e-02,  5.9776e-02, -1.0514e-01,...
         -1.0161e-01, -2.9738e-02,  2.9768e-01;...
         
         1.2541e-01,  2.0502e-01,  4.8987e-03, -2.1868e-01, -5.2907e-06,...
          6.7872e-02, -3.0092e-01, -2.3683e-02, -8.5512e-02,  4.3123e-02,...
         -5.4513e-02,  2.3696e-01,  2.0104e-01,  4.7598e-03, -8.8626e-02,...
         -8.8079e-02, -1.1660e-01,  3.5775e-01;...
         
         -1.1841e-01, -7.2742e-02, -1.1555e-01,  1.6292e-02, -2.3083e-02,...
          5.3422e-02,  8.9041e-03,  6.9135e-02,  2.3162e-01, -4.1920e-02,...
         -5.7298e-02,  4.2308e-02,  2.0940e-01,  9.6326e-02, -4.4318e-02,...
          1.6518e-01, -2.0263e-01,  3.3961e-01;...
          
          -1.4762e-01,  1.2795e-02, -1.1113e-01, -9.4180e-02,  2.6013e-01,...
         -1.3755e-01,  2.0560e-02,  1.4197e-01,  1.3606e-02,  9.4738e-02,...
          2.9942e-01,  6.2790e-05,  1.8356e-01,  8.5176e-02,  3.0523e-02,...
         -1.4879e-01,  2.2336e-01,  4.1201e-01;...
         
         -1.5356e-01,  2.4708e-01, -4.3254e-02,  9.7942e-02, -9.1360e-02,...
         -1.5663e-01, -2.1537e-01,  1.0613e-01, -1.5319e-01, -5.7519e-02,...
          1.8268e-01,  1.0821e-02,  6.8969e-03, -6.4519e-02, -1.1407e-01,...
          1.4185e-01,  8.9977e-02,  2.5765e-01;...
          
          -5.6922e-02, -8.0806e-02,  1.6502e-01,  1.2683e-01,  1.2928e-01,...
         -1.9069e-01, -5.9979e-02, -2.4886e-02, -8.2025e-02, -2.4095e-02,...
          1.6513e-01,  2.9493e-01, -3.8416e-02,  7.7798e-02, -1.1761e-01,...
         -8.9026e-03, -1.9526e-01,  3.2700e-01;...
         
         9.8373e-02, -6.9576e-02,  8.5001e-02,  8.9410e-02,  1.3877e-01,...
          2.1877e-02, -1.5100e-01,  1.6782e-01,  1.0691e-01,  9.2038e-02,...
         -8.3405e-02, -1.0804e-01, -4.1233e-02, -2.7576e-01,  3.2324e-02,...
         -1.0455e-02, -2.0526e-01,  2.8589e-01;...
         
         1.7410e-01,  5.1913e-02,  2.3613e-01,  7.4221e-03, -2.4208e-02,...
          1.6003e-01,  1.3571e-01, -2.9205e-02, -8.1848e-02, -1.4180e-02,...
         -1.4941e-01, -3.1067e-01,  1.7855e-01,  5.9664e-03, -1.3240e-01,...
         -1.3377e-01, -1.2839e-01,  1.1758e-01;...
         
         -2.1296e-01,  1.9685e-01, -1.6190e-01,  1.1110e-01,  8.5728e-02,...
         -1.8161e-01, -5.6230e-02,  1.3712e-01,  1.4510e-01, -9.6181e-02,...
          7.7364e-02,  2.5316e-01, -1.6562e-02, -2.0644e-01, -9.6709e-02,...
          6.1886e-02,  8.6724e-03,  1.9675e-01;...
          
          2.0999e-01, -3.6264e-02,  2.2593e-01,  1.6517e-01, -6.0291e-02,...
         -1.0100e-01, -1.1474e-01, -2.1570e-01, -1.7843e-02, -2.1638e-01,...
         -1.4369e-01, -1.1428e-01,  2.0450e-01, -1.0949e-01,  1.3402e-01,...
          8.3122e-02, -2.3876e-02,  3.0281e-01];
â€‹
A = sys_Id(:, 1:n);
B = sys_Id(:, n+1:18);

fx = @(x,u) eye(n) + dt*A;
fu = @(x,u) dt*B;
f = @(x,u) x(1:n) + dt * [sum(sys_Id(1,:));
    sum(sys_Id(2,:));
    sum(sys_Id(3,:));
    sum(sys_Id(4,:));
    sum(sys_Id(5,:));
    sum(sys_Id(6,:));
    sum(sys_Id(7,:));
    sum(sys_Id(8,:));
    sum(sys_Id(9,:));
    sum(sys_Id(10,:));
    sum(sys_Id(11,:));
    sum(sys_Id(12,:));
    sum(sys_Id(13,:));
    sum(sys_Id(14,:))];

end

